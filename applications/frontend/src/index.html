<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>CloudMart</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body { font-family: Arial, sans-serif; margin: 1.5rem; }
    header { margin-bottom: 1rem; }
    .products { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 1rem; }
    .card { border: 1px solid #ddd; border-radius: 6px; padding: 1rem; }
    .badge { background: #0078d4; color: white; padding: 2px 6px; border-radius: 4px; font-size: 0.75rem; }
    button { margin-top: 0.5rem; padding: 4px 8px; }
  </style>
</head>
<body>
<header>
  <h1>CloudMart Storefront</h1>
  <p>Simple e-commerce demo deployed to Azure Container Instances with Cosmos DB.</p>
</header>

<section>
  <h2>Products</h2>
  <div id="products" class="products"></div>
</section>

<script>
async function loadProducts() {
  const res = await fetch('/api/v1/products');
  const data = await res.json();
  const container = document.getElementById('products');
  container.innerHTML = '';
  data.forEach(p => {
    const div = document.createElement('div');
    div.className = 'card';
    div.innerHTML = `
      <h3>${p.name}</h3>
      <span class="badge">${p.category}</span>
      <p>${p.description || ''}</p>
      <p><strong>$${p.price}</strong></p>
      <button onclick="addToCart('${p.id}', '${p.name}')">Add to Cart</button>
    `;
    container.appendChild(div);
  });
}

async function addToCart(id, name) {
  await fetch('/api/v1/cart/items', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ id, name })
  });
  alert(`${name} added to cart`);
}

loadProducts();
</script>
</body>
</html>
